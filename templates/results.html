<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Analysis Results</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(to bottom right, #f8fafc, #e2e8f0);
      font-family: 'Segoe UI', sans-serif;
    }
    .container-box {
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      margin-top: 30px;
    }
    .section-title {
      font-weight: 600;
      border-bottom: 2px solid #dee2e6;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    .list-group-item {
      border: none;
    }
    .summary-box {
      background: #f1f5f9;
      border-left: 6px solid #0d6efd;
      padding: 15px;
      border-radius: 8px;
    }
    .video-frame {
      width: 100%;
      max-width: 560px;
      height: 315px;
      border-radius: 8px;
      box-shadow: 0 6px 12px rgba(0,0,0,0.1);
    }
    .sentiment-box {
      border-radius: 10px;
      padding: 15px;
      background: #f8fafc;
    }
    #sentimentChart {
      max-height: 250px;
    }
    .btn-download {
      background: #0d6efd;
      color: white;
    }
  </style>
</head>
<body class="py-5">
  <div class="container container-box">

    <!-- Video Embed -->
    <div class="text-center mb-4">
      <iframe class="video-frame" src="https://www.youtube.com/embed/{{ video_id }}" frameborder="0" allowfullscreen></iframe>
    </div>

    <!-- Stats -->
    <div class="row text-center mb-4">
      <div class="col">
        <h5>üìå Total Comments: <b>{{ total_comments }}</b></h5>
        <h6>üß™ Analyzed: {{ analyzed_count }}</h6>
      </div>
    </div>

    <!-- Chart + Sentiment Table -->
    <div class="row mb-5">
      <div class="col-md-6">
        <canvas id="sentimentChart"></canvas>
      </div>
      <div class="col-md-6">
        <div class="sentiment-box">
          <h5 class="section-title">üìä Sentiment Summary</h5>
          <table class="table">
            <tr><td>Positive</td><td>{{ pos }}</td></tr>
            <tr><td>Negative</td><td>{{ neg }}</td></tr>
            <tr><td>Neutral</td><td>{{ neu }}</td></tr>
          </table>
        </div>
      </div>
    </div>

    <!-- Top Comments -->
    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-header bg-success text-white">‚úÖ Top Positive Comments</div>
          <ul class="list-group list-group-flush">
            {% for comment in top_pos %}
              <li class="list-group-item">{{ comment }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-header bg-danger text-white">‚ö†Ô∏è Top Negative Comments</div>
          <ul class="list-group list-group-flush">
            {% for comment in top_neg %}
              <li class="list-group-item">{{ comment }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="mb-4 summary-box">
      <h6><b>ü§ñ AI Summary (based on Sentiment Distribution):</b></h6>
      <p class="mb-0">{{ summary_text }}</p>
    </div>

    <div class="mb-4 summary-box">
      <h6><b>üß† BART Summary:</b></h6>
      <p class="mb-0">{{ bart_summary }}</p>
    </div>

    <!-- Download Button -->
    <div class="text-center">
      <a href="/download?link={{ original_link }}" class="btn btn-download px-4 py-2">
        üìÑ Download PDF Report
      </a>
    </div>

  </div>

  <!-- Chart.js Pie -->
  <script>
    const ctx = document.getElementById('sentimentChart').getContext('2d');
    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Positive', 'Neutral', 'Negative'],
        datasets: [{
          data: [{{ pos }}, {{ neu }}, {{ neg }}],
          backgroundColor: ['#28a745', '#ffc107', '#dc3545']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              font: {
                size: 14
              }
            }
          }
        },
        cutout: '65%'
      }
    });
  </script>
</body>
</html>
